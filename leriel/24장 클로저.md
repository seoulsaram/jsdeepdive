24ì¥: í´ë¡œì € (Closure) 

> ğŸ’¡ í•µì‹¬ ê°œë…
> 
> 
> í´ë¡œì €ëŠ” í•¨ìˆ˜ê°€ ìì‹ ì´ ì •ì˜ëœ ë ‰ì‹œì»¬ í™˜ê²½ì„ "ê¸°ì–µ"í•˜ì—¬, ê·¸ í™˜ê²½ ë°–ì—ì„œ í˜¸ì¶œë˜ì–´ë„ ì›ë˜ í™˜ê²½ì˜ ë³€ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” JavaScriptì˜ í•µì‹¬ ê¸°ëŠ¥ì…ë‹ˆë‹¤.
> 

---

## 24.1 ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ (Lexical Scope)

### ğŸ” ê°œë… ì •ì˜

**ë ‰ì‹œì»¬ ìŠ¤ì½”í”„**ëŠ” í•¨ìˆ˜ê°€ **ì •ì˜ëœ ìœ„ì¹˜**ì— ë”°ë¼ ìŠ¤ì½”í”„ê°€ ê²°ì •ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. JavaScriptëŠ” ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ë¥¼ ë”°ë¥´ë©°, ì´ëŠ” í´ë¡œì €ì˜ ê¸°ë°˜ì´ ë©ë‹ˆë‹¤.

### ğŸ“Š ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ vs ë™ì  ìŠ¤ì½”í”„

| êµ¬ë¶„ | ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ (ì •ì ) | ë™ì  ìŠ¤ì½”í”„ |
| --- | --- | --- |
| **ê²°ì • ì‹œì ** | í•¨ìˆ˜ ì •ì˜ ì‹œì  | í•¨ìˆ˜ í˜¸ì¶œ ì‹œì  |
| **JavaScript** | âœ… ì‚¬ìš© | âŒ ë¯¸ì‚¬ìš© |
| **íŠ¹ì§•** | ì˜ˆì¸¡ ê°€ëŠ¥, ì•ˆì •ì  | ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ì˜ì¡´ |

### ğŸ’» ì½”ë“œ ì˜ˆì œ

```jsx
const globalVar = "ì „ì—­";

function outerFunction() {
    const outerVar = "ì™¸ë¶€";

    function innerFunction() {
        const innerVar = "ë‚´ë¶€";
        console.log(globalVar); // "ì „ì—­" - ì •ì˜ ìœ„ì¹˜ ê¸°ì¤€
        console.log(outerVar);  // "ì™¸ë¶€" - ì •ì˜ ìœ„ì¹˜ ê¸°ì¤€
        console.log(innerVar);  // "ë‚´ë¶€" - ë¡œì»¬ ìŠ¤ì½”í”„
    }

    return innerFunction;
}

const closure = outerFunction();
closure(); // í˜¸ì¶œ ìœ„ì¹˜ì™€ ê´€ê³„ì—†ì´ ì •ì˜ëœ ê³³ì˜ ìŠ¤ì½”í”„ ì‚¬ìš©

```

### ğŸ¨ ìŠ¤ì½”í”„ ì²´ì¸ ì‹œê°í™”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Global Environment
â”‚ Variables: globalVar, outerFunction     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ outerFunction() Environment         â”‚ â”‚
â”‚ â”‚ Variables: outerVar                 â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ innerFunction() Environment     â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Variables: innerVar             â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ ì ‘ê·¼: innerVar â†’ outerVar â†’ ...  â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 24.2 í•¨ìˆ˜ ê°ì²´ì˜ ë‚´ë¶€ ìŠ¬ë¡¯ [[Environment]]

### ğŸ—ï¸ ECMAScript ëª…ì„¸ì˜ ë‚´ë¶€ êµ¬ì¡°

ëª¨ë“  í•¨ìˆ˜ ê°ì²´ëŠ” ìƒì„±ë  ë•Œ **[[Environment]]** ë‚´ë¶€ ìŠ¬ë¡¯ì„ ê°€ì§€ë©°, ì´ëŠ” í•¨ìˆ˜ê°€ ì •ì˜ëœ ë ‰ì‹œì»¬ í™˜ê²½ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

```jsx
// í•¨ìˆ˜ ê°ì²´ì˜ ë‚´ë¶€ êµ¬ì¡° (ì˜ì‚¬ ì½”ë“œ)
FunctionObject = {
    [[Call]]: /* í˜¸ì¶œ ê°€ëŠ¥í•œ ë‚´ë¶€ ë©”ì„œë“œ */,
    [[Environment]]: /* ë ‰ì‹œì»¬ í™˜ê²½ì— ëŒ€í•œ ì°¸ì¡° */,
    [[FormalParameters]]: /* ë§¤ê°œë³€ìˆ˜ ëª©ë¡ */,
    [[ECMAScriptCode]]: /* í•¨ìˆ˜ ë³¸ë¬¸ */
    // ... ê¸°íƒ€ ë‚´ë¶€ ìŠ¬ë¡¯ë“¤
};

```

### ğŸ”— [[Environment]] ìŠ¬ë¡¯ì˜ ë™ì‘

```jsx
function createCounter() {
    let count = 0; // ì´ ë³€ìˆ˜ê°€ í¬í•¨ëœ ë ‰ì‹œì»¬ í™˜ê²½

    return function increment() {
        return ++count;
    };
    // increment í•¨ìˆ˜ì˜ [[Environment]]ì—
    // createCounterì˜ ë ‰ì‹œì»¬ í™˜ê²½ ì°¸ì¡°ê°€ ì €ì¥ë¨
}

const counter = createCounter();

// counter í•¨ìˆ˜ ê°ì²´ì˜ [[Environment]]ë¥¼ í†µí•´ countì— ì ‘ê·¼
console.log(counter()); // 1
console.log(counter()); // 2

```

### âš™ï¸ ë‚´ë¶€ ë™ì‘ ê³¼ì •

1. `createCounter` í˜¸ì¶œ â†’ ìƒˆë¡œìš´ ë ‰ì‹œì»¬ í™˜ê²½ ìƒì„±
2. `increment` í•¨ìˆ˜ ìƒì„± â†’ `[[Environment]]`ì— í˜„ì¬ ë ‰ì‹œì»¬ í™˜ê²½ ì°¸ì¡° ì €ì¥
3. `createCounter` ì‹¤í–‰ ì™„ë£Œ â†’ ì¼ë°˜ì ìœ¼ë¡œ ë ‰ì‹œì»¬ í™˜ê²½ ì†Œë©¸
4. **í•˜ì§€ë§Œ** `increment`ì˜ `[[Environment]]` ì°¸ì¡°ë¡œ ì¸í•´ í™˜ê²½ ìœ ì§€
5. `counter()` í˜¸ì¶œ â†’ `[[Environment]]`ë¥¼ í†µí•´ `count` ì ‘ê·¼

---

## 24.3 í´ë¡œì €ì™€ ë ‰ì‹œì»¬ í™˜ê²½

### ğŸ’¡ í´ë¡œì € ì •ì˜

> í´ë¡œì €(Closure)
> 
> 
> í•¨ìˆ˜ê°€ ìì‹ ì˜ ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ë¥¼ ê¸°ì–µí•˜ì—¬, ìŠ¤ì½”í”„ ë°–ì—ì„œ í˜¸ì¶œë˜ì–´ë„ ê·¸ ìŠ¤ì½”í”„ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥
> 

### ğŸ­ í´ë¡œì € í˜•ì„± ê³¼ì •

```jsx
function outerFunction(x) {
    // 1. outerFunctionì˜ ë ‰ì‹œì»¬ í™˜ê²½ ìƒì„±
    const outerVar = x * 2;
    // outerVar = 20

    function innerFunction(y) {
        // 2. innerFunction ì •ì˜ ì‹œ [[Environment]]ì—
        //    outerFunctionì˜ ë ‰ì‹œì»¬ í™˜ê²½ ì°¸ì¡° ì €ì¥
        return outerVar + y; // 3. ì™¸ë¶€ ë³€ìˆ˜ì— ì ‘ê·¼
    }

    return innerFunction; // 4. í´ë¡œì € ë°˜í™˜
}

const closure = outerFunction(10); // 5. í´ë¡œì € ìƒì„±
console.log(closure(5)); // 25 - 6. í´ë¡œì €ë¥¼ í†µí•œ ì™¸ë¶€ ë³€ìˆ˜ ì ‘ê·¼

```

### ğŸ§  ë©”ëª¨ë¦¬ ê´€ì ì—ì„œì˜ í´ë¡œì €

```
ì‹¤í–‰ ì „: ì¤€ë¹„ ìƒíƒœ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Global Environment  â”‚
â”‚ outerFunction: fn   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì‹¤í–‰ ì¤‘: í´ë¡œì € í˜•ì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Global Environment  â”‚
â”‚ closure: fn â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                         â”‚ [[Environment]] ì°¸ì¡°
                         â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ outerFunction Env   â”‚
            â”‚ x: 10, outerVar: 20 â”‚ â† ìœ ì§€ë¨!
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 24.4 í´ë¡œì €ì˜ í™œìš©

### ğŸ”¢ ì¹´ìš´í„° í•¨ìˆ˜ êµ¬í˜„

### ê¸°ë³¸ ì¹´ìš´í„°

```jsx
function createCounter() {
    let count = 0;

    return function() {
        return ++count;
    };
}

const counter1 = createCounter();
const counter2 = createCounter();

console.log(counter1()); // 1
console.log(counter1()); // 2
console.log(counter2()); // 1 (ë…ë¦½ì ì¸ ì¹´ìš´í„°)

```

### ê³ ê¸‰ ì¹´ìš´í„°

```jsx
function createAdvancedCounter(initialValue = 0) {
    let count = initialValue;

    return {
        increment() { return ++count; },
        decrement() { return --count; },
        getValue() { return count; },
        reset() {
            count = initialValue;
            return count;
        }
    };
}

const counter = createAdvancedCounter(10);
console.log(counter.increment()); // 11
console.log(counter.decrement()); // 10
console.log(counter.getValue());  // 10

```

### ğŸ­ íŒ©í† ë¦¬ í•¨ìˆ˜ íŒ¨í„´

```jsx
function createUser(userData) {
    // ë¹„ê³µê°œ ë°ì´í„°
    let _id = Math.random().toString(36).substr(2, 9);
    let _email = userData.email;
    let _createdAt = new Date();

    // ë¹„ê³µê°œ ë©”ì„œë“œ
    function validateEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    if (!validateEmail(_email)) {
        throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼');
    }

    // ê³µê°œ API
    return {
        get id() { return _id; },
        get email() { return _email; },
        get createdAt() { return new Date(_createdAt); },

        updateEmail(newEmail) {
            if (!validateEmail(newEmail)) {
                throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼');
            }
            _email = newEmail;
            return this;
        },

        toJSON() {
            return {
                id: _id,
                email: _email,
                createdAt: _createdAt
            };
        }
    };
}

const user = createUser({ email: 'user@example.com' });
console.log(user.email); // 'user@example.com'
// console.log(user._email); // undefined (ì ‘ê·¼ ë¶ˆê°€)

```

---

## 24.5 ìº¡ìŠí™”ì™€ ì •ë³´ ì€ë‹‰

### ğŸ›ï¸ ëª¨ë“ˆ íŒ¨í„´ (Module Pattern)

```jsx
const Calculator = (function() {
    // ë¹„ê³µê°œ ë³€ìˆ˜ë“¤
    let result = 0;
    let history = [];

    // ë¹„ê³µê°œ ë©”ì„œë“œ
    function addToHistory(operation, value, newResult) {
        history.push({
            operation,
            value,
            previousResult: result,
            newResult
        });
    }

    // ê³µê°œ API ë°˜í™˜
    return {
        add(value) {
            result += value;
            addToHistory('add', value, result);
            return this; // ë©”ì„œë“œ ì²´ì´ë‹
        },

        subtract(value) {
            result -= value;
            addToHistory('subtract', value, result);
            return this;
        },

        getResult() { return result; },
        getHistory() { return [...history]; }, // ë³µì‚¬ë³¸ ë°˜í™˜

        clear() {
            result = 0;
            history = [];
            return this;
        }
    };
})();

// ì‚¬ìš© ì˜ˆì œ
Calculator.add(10).subtract(3).add(5);
console.log(Calculator.getResult()); // 12

```

### ğŸ¦ ì€í–‰ ê³„ì¢Œ ì˜ˆì œ

```jsx
function createBankAccount(accountNumber, initialBalance = 0) {
    // ì™„ì „íˆ ë¹„ê³µê°œì¸ ë°ì´í„°
    let _balance = initialBalance;
    let _accountNumber = accountNumber;
    let _transactions = [];
    let _isLocked = false;

    // ë¹„ê³µê°œ ë©”ì„œë“œë“¤
    function addTransaction(type, amount, description) {
        _transactions.push({
            type,
            amount,
            description,
            timestamp: new Date(),
            balanceAfter: _balance
        });
    }

    function validateAmount(amount) {
        return typeof amount === 'number' && amount > 0;
    }

    function checkLocked() {
        if (_isLocked) {
            throw new Error('ê³„ì¢Œê°€ ì ê²¨ìˆìŠµë‹ˆë‹¤.');
        }
    }

    // ê³µê°œ API
    return {
        deposit(amount, description = 'ì…ê¸ˆ') {
            checkLocked();
            if (!validateAmount(amount)) {
                throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ê¸ˆì•¡ì…ë‹ˆë‹¤.');
            }

            _balance += amount;
            addTransaction('deposit', amount, description);
            return this;
        },

        withdraw(amount, description = 'ì¶œê¸ˆ') {
            checkLocked();
            if (!validateAmount(amount)) {
                throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ê¸ˆì•¡ì…ë‹ˆë‹¤.');
            }
            if (amount > _balance) {
                throw new Error('ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.');
            }

            _balance -= amount;
            addTransaction('withdrawal', amount, description);
            return this;
        },

        getBalance() { return _balance; },
        getAccountNumber() { return _accountNumber; },
        getTransactionHistory(limit = 10) {
            return _transactions.slice(-limit).map(t => ({ ...t }));
        },

        lock() {
            _isLocked = true;
            return this;
        },

        unlock() {
            _isLocked = false;
            return this;
        }
    };
}

const account = createBankAccount('123-456-789', 1000);
account.deposit(500).withdraw(200);
console.log(account.getBalance()); // 1300

```

### ğŸ†š ìº¡ìŠí™” ë°©ë²• ë¹„êµ

| ë°©ë²• | ì§„ì •í•œ ìº¡ìŠí™” | ì„±ëŠ¥ | ìƒì† ì§€ì› | ë¬¸ë²• ë³µì¡ë„ |
| --- | --- | --- | --- | --- |
| **í´ë¡œì €** | âœ… ì™„ë²½ | ğŸŸ¡ ë³´í†µ | âŒ ì–´ë ¤ì›€ | ğŸŸ¡ ë³´í†µ |
| **ES6 í´ë˜ìŠ¤** | ğŸŸ¡ ì œí•œì  | âœ… ìš°ìˆ˜ | âœ… ì™„ë²½ | âœ… ê°„ë‹¨ |
| **Private Fields (#)** | âœ… ì™„ë²½ | âœ… ìš°ìˆ˜ | âœ… ì™„ë²½ | âœ… ê°„ë‹¨ |

---

## 24.6 ìì£¼ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜

### âš ï¸ ë°˜ë³µë¬¸ì—ì„œì˜ í´ë¡œì € í•¨ì •

### ğŸš¨ ë¬¸ì œ ìƒí™©

```jsx
// ì˜ëª»ëœ ì½”ë“œ - ëª¨ë“  í•¨ìˆ˜ê°€ ê°™ì€ ë³€ìˆ˜ë¥¼ ì°¸ì¡°
var functions = [];
for (var i = 0; i < 3; i++) {
    functions[i] = function() {
        return i; // ëª¨ë“  í•¨ìˆ˜ê°€ 3ì„ ë°˜í™˜
    };
}

console.log(functions[0]()); // 3 (ì˜ˆìƒ: 0)
console.log(functions[1]()); // 3 (ì˜ˆìƒ: 1)
console.log(functions[2]()); // 3 (ì˜ˆìƒ: 2)

```

### ğŸ” ë¬¸ì œ ì›ì¸ ë¶„ì„

```
ë¬¸ì œ: var í‚¤ì›Œë“œë¡œ ì„ ì–¸ëœ iëŠ” í•¨ìˆ˜ ìŠ¤ì½”í”„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì „ì—­ ìŠ¤ì½”í”„                        â”‚
â”‚ var i = 3 (ìµœì¢…ê°’)                â”‚ â† ëª¨ë“  í´ë¡œì €ê°€ ì´ ië¥¼ ì°¸ì¡°
â”‚ functions = [fn, fn, fn]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### âœ… í•´ê²°ì±…ë“¤

**ë°©ë²• 1: let í‚¤ì›Œë“œ ì‚¬ìš©**

```jsx
var functions = [];
for (let i = 0; i < 3; i++) { // let ì‚¬ìš©
    functions[i] = function() {
        return i; // ê°ê° 0, 1, 2 ë°˜í™˜
    };
}

```

**ë°©ë²• 2: IIFE (ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜) ì‚¬ìš©**

```jsx
var functions = [];
for (var i = 0; i < 3; i++) {
    functions[i] = (function(index) {
        return function() {
            return index;
        };
    })(i); // ì¦‰ì‹œ ì‹¤í–‰ìœ¼ë¡œ í˜„ì¬ i ê°’ì„ ìº¡ì²˜
}

```

**ë°©ë²• 3: bind ë©”ì„œë“œ ì‚¬ìš©**

```jsx
var functions = [];
for (var i = 0; i < 3; i++) {
    functions[i] = function(index) {
        return index;
    }.bind(null, i);
}

```

**ë°©ë²• 4: forEach ì‚¬ìš©**

```jsx
var functions = [];
[0, 1, 2].forEach(function(i) {
    functions[i] = function() {
        return i; // ê° ë°˜ë³µë§ˆë‹¤ ìƒˆë¡œìš´ ìŠ¤ì½”í”„
    };
});

```

### ğŸ¯ í•´ê²°ì±… ì‹œê°í™”

```
let ì‚¬ìš© ì‹œ: ê° ë°˜ë³µë§ˆë‹¤ ìƒˆë¡œìš´ ë¸”ë¡ ìŠ¤ì½”í”„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°˜ë³µ 1 - ë¸”ë¡ ìŠ¤ì½”í”„                â”‚
â”‚ let i = 0                       â”‚ â† í´ë¡œì € 1ì´ ì°¸ì¡°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°˜ë³µ 2 - ë¸”ë¡ ìŠ¤ì½”í”„                â”‚
â”‚ let i = 1                       â”‚ â† í´ë¡œì € 2ê°€ ì°¸ì¡°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë°˜ë³µ 3 - ë¸”ë¡ ìŠ¤ì½”í”„                â”‚
â”‚ let i = 2                       â”‚ â† í´ë¡œì € 3ì´ ì°¸ì¡°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### ğŸ’¾ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

### ğŸš¨ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ìœ„í—˜ ì½”ë“œ

```jsx
function createLeakyHandler() {
    const largeData = new Array(1000000).fill('data'); // 4MB

    return function(event) {
        // largeDataë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ í´ë¡œì €ë¡œ ì¸í•´ ë©”ëª¨ë¦¬ì— ë‚¨ìŒ
        console.log('Event handled');
    };
}

// 100ê°œì˜ í•¸ë“¤ëŸ¬ ìƒì„± ì‹œ 400MB ë©”ëª¨ë¦¬ ì‚¬ìš©!
const handlers = [];
for (let i = 0; i < 100; i++) {
    handlers.push(createLeakyHandler());
}

```

### âœ… ë©”ëª¨ë¦¬ ìµœì í™” ì½”ë“œ

```jsx
function createEfficientHandler() {
    const largeData = new Array(1000000).fill('data');
    const neededData = largeData.slice(0, 10); // í•„ìš”í•œ ë¶€ë¶„ë§Œ ì¶”ì¶œ

    return function(event) {
        console.log('Event handled', neededData[0]);
        // largeDataëŠ” ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ëŒ€ìƒì´ ë¨
    };
}

// ì •ë¦¬ í•¨ìˆ˜ë¥¼ ì œê³µí•˜ëŠ” íŒ¨í„´
function createCleanupableModule() {
    let resources = [];
    let isDestroyed = false;

    return {
        addResource(resource) {
            if (isDestroyed) return;
            resources.push(resource);
        },

        destroy() {
            resources.forEach(resource => {
                if (resource.cleanup) {
                    resource.cleanup();
                }
            });
            resources = null;
            isDestroyed = true;
        }
    };
}

```

---

## ğŸ¨ ê³ ê¸‰ í™œìš© íŒ¨í„´

### ğŸ› ì»¤ë§ (Currying)

```jsx
// í´ë¡œì €ë¥¼ í™œìš©í•œ ì»¤ë§
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        } else {
            return function(...nextArgs) {
                return curried.apply(this, args.concat(nextArgs));
            };
        }
    };
}

// ì‚¬ìš© ì˜ˆì œ
const add = (a, b, c) => a + b + c;
const curriedAdd = curry(add);

const add5 = curriedAdd(5);
const add5And10 = add5(10);
console.log(add5And10(3)); // 18

// ë˜ëŠ” ì²´ì´ë‹ìœ¼ë¡œ
console.log(curriedAdd(1)(2)(3)); // 6

```

### ğŸ”€ ë¶€ë¶„ ì ìš© (Partial Application)

```jsx
function partial(fn, ...presetArgs) {
    return function(...laterArgs) {
        return fn(...presetArgs, ...laterArgs);
    };
}

// ì‚¬ìš© ì˜ˆì œ
function multiply(a, b, c) {
    return a * b * c;
}

const double = partial(multiply, 2);
const quadruple = partial(multiply, 2, 2);

console.log(double(3, 4)); // 24 (2 * 3 * 4)
console.log(quadruple(5)); // 20 (2 * 2 * 5)

```

### ğŸ£ ë©”ëª¨ì´ì œì´ì…˜ (Memoization)

```jsx
function memoize(fn) {
    const cache = new Map();

    return function(...args) {
        const key = JSON.stringify(args);

        if (cache.has(key)) {
            console.log('ìºì‹œì—ì„œ ë°˜í™˜:', key);
            return cache.get(key);
        }

        const result = fn.apply(this, args);
        cache.set(key, result);
        console.log('ê³„ì‚° í›„ ìºì‹œ:', key);
        return result;
    };
}

// í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ ì˜ˆì œ
const fibonacci = memoize(function(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
});

console.log(fibonacci(10)); // 55 (ìµœì´ˆ ê³„ì‚°)
console.log(fibonacci(10)); // 55 (ìºì‹œì—ì„œ ë°˜í™˜)

```

---

## ğŸ“Š ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

### âš¡ í´ë¡œì € ì„±ëŠ¥ íŠ¹ì„±

| ì¸¡ë©´ | ì˜í–¥ | ìµœì í™” ë°©ë²• |
| --- | --- | --- |
| **ë©”ëª¨ë¦¬ ì‚¬ìš©** | ì™¸ë¶€ í™˜ê²½ ì°¸ì¡°ë¡œ ì¸í•œ ì¦ê°€ | í•„ìš”í•œ ë³€ìˆ˜ë§Œ ì‚¬ìš© |
| **ì‹¤í–‰ ì†ë„** | ìŠ¤ì½”í”„ ì²´ì¸ íƒìƒ‰ ì˜¤ë²„í—¤ë“œ | ì§€ì—­ ë³€ìˆ˜ í™œìš© |
| **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜** | ì°¸ì¡°ë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ë³´ì¡´ | ì ì ˆí•œ ì°¸ì¡° í•´ì œ |

### ğŸ¯ ìµœì í™” íŒ

```jsx
// âŒ ë¹„íš¨ìœ¨ì  - ë¶ˆí•„ìš”í•œ ëŒ€ìš©ëŸ‰ ê°ì²´ ì°¸ì¡°
function inefficient() {
    const massiveArray = new Array(1000000);
    const smallValue = 42;

    return function() {
        return smallValue; // massiveArrayë„ í•¨ê»˜ ì°¸ì¡°ë¨
    };
}

// âœ… íš¨ìœ¨ì  - í•„ìš”í•œ ê°’ë§Œ ì¶”ì¶œ
function efficient() {
    const massiveArray = new Array(1000000);
    const smallValue = 42;

    // í•„ìš”í•œ ê°’ë§Œ ì¶”ì¶œ í›„ ëŒ€ìš©ëŸ‰ ê°ì²´ëŠ” GC ëŒ€ìƒì´ ë¨
    return function() {
        return smallValue;
    };
}

// âœ… ë” íš¨ìœ¨ì  - ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬
function mostEfficient(value) {
    return function() {
        return value;
    };
}

```

---

## ğŸ†š í˜„ëŒ€ì  ëŒ€ì•ˆë“¤

### ES6+ í´ë˜ìŠ¤ vs í´ë¡œì €

### í´ë¡œì € ë°©ì‹

```jsx
function createCounter(initial = 0) {
    let count = initial;

    return {
        increment: () => ++count,
        decrement: () => --count,
        getValue: () => count
    };
}

```

### ES6 í´ë˜ìŠ¤ ë°©ì‹

```jsx
class Counter {
    #count = 0; // Private field (ES2022)

    constructor(initial = 0) {
        this.#count = initial;
    }

    increment() { return ++this.#count; }
    decrement() { return --this.#count; }
    getValue() { return this.#count; }
}

```

### ğŸ¤” ì–¸ì œ ì–´ë–¤ íŒ¨í„´ì„ ì‚¬ìš©í• ê¹Œ?

### í´ë¡œì € ì‚¬ìš© ì‹œê¸°

- âœ… í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼
- âœ… ì¦‰ì‹œ ì‹¤í–‰ë˜ëŠ” ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤
- âœ… ì§„ì •í•œ ë°ì´í„° ìº¡ìŠí™” í•„ìš”
- âœ… ê³ ì°¨ í•¨ìˆ˜ë‚˜ íŒ©í† ë¦¬ íŒ¨í„´
- âœ… ë ˆê±°ì‹œ í™˜ê²½ ì§€ì› í•„ìš”

### í´ë˜ìŠ¤ ì‚¬ìš© ì‹œê¸°

- âœ… ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼
- âœ… ìƒì†ì´ í•„ìš”í•œ ê²½ìš°
- âœ… ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í•„ìš”
- âœ… TypeScriptì™€ì˜ í˜¸í™˜ì„±
- âœ… íŒ€ì˜ í‘œì¤€ ì»¨ë²¤ì…˜

---