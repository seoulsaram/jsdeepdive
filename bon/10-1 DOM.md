## DOM이란?

DOM은 HTML문서의 계층적 구조를 트리 자료구조로 만든 것이다.
DOM의 노드들은 HTML 요소를 객체로 변환한 것으로,
HTML요소에 대한 정보를 제공하고, 이를 제어할 수 있는 API를 제공한다.

👉 즉 HTML을 동적으로 지지고 볶으려면 HTML이 DOM으로 변환되어야 한다.


## HTML요소란?

HTML 문서를 구성하는 개별 요소를 HTML요소라고 한다.
HTML요소는 렌더링 엔진에 의해 파싱되어
DOM을 구성하는 요소 노드 객체로 변환된다.

```html
<!-- 이것이 HTML 요소 -->
<div class="hello">Hello</div>
```

HTML요소의 구조는 아래와 같이 구성된다.
- 시작-종료tag (`<div></div>`)
- 어트리뷰트 이름, 어트리뷰트 값 (`class="hello"`)
- 콘텐츠 (Hello)

HTML요소가 요소 노드 객체로 변환될 때
어트리뷰트(`class="hello"`)는 어트리뷰트 노드로,
텍스트 콘텐츠(Hello)는 텍스트 노드로 변환된다.

![[스크린샷 2025-07-22 오후 5.01.12.png]]


HTML문서는 HTML 요소들의 집합으로 이루어진다.
HTML요소의 콘텐츠 영역(시작 태그와 종료 태그 사이)에는
텍스트 뿐 아니라 다른 HTML 요소도 포함될 수 있다.

```html

<div>
	텍스트 요
	<p>다른 html요소!</p>
</div>

```


이때 HTML요소 간에는 중첩 관계에 의한 부자(perent-child)관계가 형성된다.
HTML요소를 객체화한 모든 노드 객체들을 트리 자료로 구성한게 DOM이다.

---

## 트리 자료구조

트리는 노드들의 집합이며, 하나의 루트노드에서 시작한다.
각 노드는 여러 개의 자식 노드를 가질 수 있다.
노드들 간에는 사이클이 없고, 하나의 부모만을 가진다.

![[스크린샷 2025-07-22 오후 5.13.33.png]]

- root : 트리의 최상단 노드 (시작점)
- node : 데이터를 담는 단위
- edge : 노드와 노드를 연결하는 선
- leaf : 자식이 없는 노드
- sibling : 같은 부모를 가진 노드
- depth : 루트에서 해당 노드까지의 거리
- height : 노드에서 가장 깊은 leaf까지의 거리

### 트리의 종류

이진 트리 (Binary tree)
- 각 노드가 최대 두 개의 자식 노드를 가짐 (left, right)


이진 탐색 트리 (BST, Binary Search Tree)
- 왼쪽 자식 노드는 현재 노드보다 작고, 오른쪽은 큼
- 검색, 삽입, 삭제 시간복잡도 : 평균 `O(log n)`
값을 순서대로 삽입: `15, 10, 20, 8, 12, 17, 25` 한다면
BST 구조는 이렇게 된다:
```
        15
       /  \
     10    20
     / \   / \
    8  12 17 25
```



균형 이진 트리 (AVL Tree, Red-Black Tree 등)
- 트리의 균형을 유지하여 성능을 보장함 (`log n` 시간 보장)
- 이진 탐색 트리의 단점을 보완한 자료구조.
- 일반 이진 탐색 트리는 삽입 순서에 따라 트리가 한쪽으로 쏠릴 수 있음 (아래 예시)
```
1
 \
  2
   \
    3
     \
      4
```
이렇게 되면 링크드 리스트랑 비슷해지고 탐색이 `O(n)`이 돼버림.
균형 이진 트리는 높이를 자동으로 조정해서
성능이 나빠지지 않도록 유지함. (아래 예시)
```
      2
     / \
    1   3
           \
            4
```


완전 이진 트리 (Complete Binary Tree)
- 왼쪽부터 채워진 이진 트리.
완전 이진트리 예
```
         1
       /   \
      2     3
     / \   /
    4   5 6
```

완전하지 않은 이진트리 예
```
         1
       /   \
      2     3
           /
          4
```


힙 (Heap)
- 완전 이진 트리이며, 부모가 자식보다 항상 크거나 작음 (최대/최소 힙)

n-진 트리 (N-ary Tree)
- 노드가 n개의 자식을 가질 수 있음 (예: 폴더구조)
- DOM이 여기에 해당함!

---

## 노드 객체의 타입 (종류)

DOM을 구성하는 노드 객체들에는 종류가 있다.
총 12개의 종류가가 있다.

| 노드 타입                   | `nodeType` | 설명                                                             |
| ----------------------- | ---------- | -------------------------------------------------------------- |
| `Element`               | `1`        | HTML 요소 노드 (`<div>`, `<p>` 등)                                  |
| `Attribute`             | `2`        | 요소의 속성 노드 (`class="box"` 등) — 단, 현대 JS에서는 속성을 노드로 다루는 일은 거의 없음 |
| `Text`                  | `3`        | 요소 내부의 텍스트 노드 (`<p>hello</p>`의 "hello" 부분)                     |
| `CDATASection`          | `4`        | CDATA 구역 (XML에서 사용, HTML에는 없음)                                 |
| `EntityReference`       | `5`        | 엔티티 참조 (`&nbsp;`, `&amp;` 등 – 거의 안 씀)                          |
| `Entity`                | `6`        | 문서 엔티티 노드 (사용 안 함, 구형 XML용)                                    |
| `ProcessingInstruction` | `7`        | XML 처리 명령 노드 (`<?xml-stylesheet?>` 등)                          |
| `Comment`               | `8`        | 주석 노드 (`<!-- comment -->`)                                     |
| `Document`              | `9`        | 전체 문서를 대표하는 루트 객체 (`document`)                                 |
| `DocumentType`          | `10`       | 문서 타입 선언 (`<!DOCTYPE html>`)                                   |
| `DocumentFragment`      | `11`       | 메모리상의 임시 DOM 조각 (렌더링되지 않음, 조작에 매우 유용)                          |
| `Notation`              | `12`       | DTD에서 사용하는 선언 (거의 사용하지 않음)                                     |

여기서 nodeType은 아래와 같이 활용할 수 있다. (이렇게 잘 안쓰긴 함)

```js

// 텍스트 노드인지 확인할 때
const p = document.querySelector('p');
const firstChild = p.firstChild;

if (firstChild.nodeType === 3) {
  console.log('텍스트 노드입니다:', firstChild.nodeValue);
}
```


자주 쓰는 6가지 노드 타입들에 대해 알아보자.

### Element (nodeType === 1)

- 요소 노드.
- 태그 그 자체를 나타내는 노드다.
- 예 : `<div>` `<ul>` ...
- 요소 노드는 문서의 구조를 표현한다.

```js
const el = document.querySelector('div');
console.log(el.nodeType); // 1
```


### Text (nodeType === 3)

- 텍스트 내용을 담는 노드.
- 예 : `<p>Hello</p>` -> "Hello"는 Text 노드
- 텍스트 노드는 요소 노드의 자식 노드이며, 자식 노드를 가질 수 없는 리프 노드다.
- 따라서 텍스트 노드에 접근하려면 먼저 부모 노드인 요소 노드에 접근해야 한다.

```js
const textNode = document.querySelector('p').firstChild;
console.log(textNode.nodeType); // 3
console.log(textNode.nodeValue); // "Hello"
```


### Comment (nodeType === 8)

- HTML 주석을 표현하는 노드
- 예: `<!-- 주석입니다 -->`

### Document (nodeType === 9)

- 문서노드.
- DOM트리의 루트 노드 (`document`)
- 이 노드를 통해 전체 DOM에 접근 가능.
- 문서 노드는 DOM트리 최상위에 존재하는 루트 노드로서 document 객체를 가리킨다.
- document객체는 브라우저가 렌더링한 html문서 전체를 가리키는 체다.
- document 객체는 DOM트리의 루트 노드이므로 DOM트리의 노드들에 접근하기 위한 진입점 역할을 담당한다.

```js
console.log(document.nodeType); // 9
```


### DocumentFragment (nodeType === 11)

- DOM조각을 메모리상에서만 다루는 가상의 컨테이너.
- 실제 DOM에 붙기 전 임시 저장소로 사용됨
```js
const frag = document.createDocumentFragment();
frag.appendChild(document.createElement('li'));
// 화면에는 보이지 않지만, 이후 한 번에 붙일 수 있음
```


### Attribute (nodeType === 2)

- 어트리뷰트 노드는 HTML요소의 어트리뷰트를 가리키는 객체.
- 어트리뷰트 노드는 어트리뷰트가 지정된 HTML요소의
- 요소 노드와 연결되어 있다.

```js
const el = document.querySelector('div');
const attr = el.attributes[0];
console.log(attr.nodeType); // 2
```

---

## 📚 중간 퀴즈

위 내용을 토대로 아래 html에서 div의 lang어트리뷰트를 출력해보자.

```html
<div lang="fr">
	<p>Hello World!</p>
</div>
```

답
```js
const div = document.querySelector('div');

const attr = div.attributes;
console.log(attr.lang)
```


---

## 노드 객체 상속 구조


모든 노드 객체는 `Object`, `EventTarget`, `Node` 인터페이스를 상속받는다.
추가적으로 문서 노드는 `Document`, `HTMLDocument` 인터페이스를,
어트리뷰트 노드는 `Attr`,
텍스트 노드는 `CharacterData` 인터페이스를,
요소노드는 `Element` 인터페이스를 상속받는다.
요소노드는 추가적으로 HTMLElement와 태그의 종류별로 세분화된 인터페이스를 상속받는다.

![[스크린샷 2025-07-22 오후 6.52.14.png]]


여기서 각 객체의 특성을 알아보면
- Object : 걍 객체
- EventTarget : 이벤트를 발생시키는 객체. 이벤트에 관련된 기능은 EventTarget 인터페이스가 제공한다.
- Node : 트리 자료구조의 노드 객체. 트리 탐색 기능이나 노드 정보 제공 기능은 Node 인터페이스가 제공한다. (`Node.parentNode`, `Node.childNodes`, `Node.nodeType` ...)
- Element : 브라우저가 렌더링할 수 있는 웹 문서의 요소(HTML, XML, SVG)를 표현하는 객체. 
- HTMLElement : 웹 문서의 요소 중에서 HTML 요소를 표현하는 객체. HTML요소가 갖는 공통적인 기능은 HTMLElement 인터페이스가 제공한다. (`Element.style` ...)


##### 💡자주 헷갈리는 Elemen와 HTMLElement 차이

| 항목        | `Element`                                          | `HTMLElement`                                               |
| --------- | -------------------------------------------------- | ----------------------------------------------------------- |
| 대상 범위     | HTML, SVG, MathML 등 모든 DOM 요소                      | 오직 HTML 요소만                                                 |
| 상속        | `Node` → `Element`                                 | `Element` → `HTMLElement`                                   |
| 공통 속성     | `tagName`, `attributes`, `classList`, `children` 등 | 모두 있음                                                       |
| 고유 속성     | 없음 (공통 요소만 가짐)                                     | `innerHTML`, `innerText`, `accessKey`, `title`, `dataset` 등 |
| 사용 예      | HTML + SVG 같이 쓸 때 범용적으로                            | HTML 전용 조작 시                                                |
| typeof 결과 | `[object Element]`                                 | `[object HTMLElement]`                                      |


##### input요소 노드객체의 프로토타입 체인을 살펴보자!

![[스크린샷 2025-07-22 오후 6.53.13.png]]

💡 이걸 자바스크립트 코드로 '증명'해보면?
```js

const input = document.querySelector('input');

console.log(
Object.getPrototypeOf(input) === HTMLInputElement.prototype,
 Object.getPrototypeOf(HTMLInputElement.prototype) === HTMLElement.prototype,
 Object.getPrototypeOf(HTMLElement.prototype) === Element.prototype,
 Object.getPrototypeOf(Element.prototype) === Node.prototype,
 Object.getPrototypeOf(Node.prototype) === EventTarget.prototype,
 Object.getPrototypeOf(EventTarget.prototype) === Object.prototype
) // true true true true true true
```


이처럼 노드 객체는 공통된 기능일수록 프로토타입 체인의 상위에,
개별적인 고유 기능일수록 프로토타입 체인의 하위에 프로토타입 체인이 구축되어 있다.


---

## 📚 마지막 퀴즈

위 내용을 이해하여
1. Text노드 객체의 상속구조를 그려보자. 그리고 js로 증명해보자.
	힌트 : 텍스트노드 가져오기
```js
<div>
   텍스트
</div>

const div = document.querySelector('div');
const textNode = div.firstChild;

//객체의 상속구조
//Object<-EventTarget<-


```

2. 어트리뷰트 노드 객체의 상속구조를 그려보자. 그리고 js로 증명해보자.
	힌트: 어트리뷰트노드 가져오기
```js
const div = document.querySelector('div');
const attrNode = div.attributes[0];
```


3. p요소 노드 객체의 상속구조를 그려보자. 그리고 js로 증명해보자.



답 1.
```js

//텍스트노드의 상속구조
Object<-EventTarget<-Node<-CharacterData<-Text

const div = document.querySelector('div');
const textNode = div.firstChild;

// 검증
console.log(
    Object.getPrototypeOf(textNode) === Text.prototype,
    Object.getPrototypeOf(Text.prototype) === CharacterData.prototype,
    Object.getPrototypeOf(CharacterData.prototype) === Node.prototype,
    Object.getPrototypeOf(Node.prototype) === EventTarget.prototype,
    Object.getPrototypeOf(EventTarget.prototype) === Object.prototype,
)
```


답 2.
```js
//어트리뷰트노드의 상속구조
Object<-EventTarget<-Node<-Attr

const div = document.querySelector('div');
const attrNode = div.attributes[0];

// 검증
console.log(
    Object.getPrototypeOf(attrNode) === Attr.prototype,
    Object.getPrototypeOf(Attr.prototype) === Node.prototype,
    Object.getPrototypeOf(Node.prototype) === EventTarget.prototype,
    Object.getPrototypeOf(EventTarget.prototype) === Object.prototype,
)
```
=> 하지만 사양상으로는 이제 Object<-Attr로 변경됨
하지만 브라우저는 호환상의 목적으로 Attr을 Node로 구현해놓음.
하지만 언제 Attr의 구현사항에서 Node가 사라질지 모르기때문에
Object<-Attr (사양상 정의)로 알고있는것이 좋다.


답 3.
```js
Object<-EventTarget<-Node<-Element<-HTMLElement<-HTMLParagraphElement

const p = document.querySelector('p');

//검증
console.log(
    Object.getPrototypeOf(p) === HTMLParagraphElement.prototype,
    Object.getPrototypeOf(HTMLParagraphElement.prototype) === HTMLElement.prototype,
    Object.getPrototypeOf(HTMLElement.prototype) === Element.prototype,
    Object.getPrototypeOf(Element.prototype) === Node.prototype,
  Object.getPrototypeOf(Node.prototype) === EventTarget.prototype,
    Object.getPrototypeOf(EventTarget.prototype) === Object.prototype,
)
```

